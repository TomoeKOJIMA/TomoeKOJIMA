<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>つくるについて考える</title>
    <style>
        body, html {
            margin: 0;
            padding: 0;
            background-color: #333;
            width: 100%;
            height: 100vh; /* 画面全体の高さを100%にする */

            /* ▼上下左右の中央揃えにします▼ */
            display: flex;
            justify-content: center; /* 水平方向の中央揃え */
            align-items: center;     /* 垂直方向の中央揃え */
        }
        #image-mask {
            width: 100%;
            max-width: 850px;
            height: 0;
            overflow: hidden;
        }
        #image-mask img {
            display: block;
            width: 100%;
        }
    </style>
</head>
<body>

    <div id="image-mask">
        <img id="reveal-image" src="gallery1_plan.png" alt="Loading Document...">
    </div>

    <script>
        const mask = document.getElementById('image-mask');
        const image = document.getElementById('reveal-image');
        let fullHeight = 0;
        let currentStepIndex = 0;

        // ▼ ランダムなアニメーションパターンを生成する関数 ▼
        function generateRandomSteps() {
            const steps = [];
            let cumulativePercent = 0;

            // 合計が90%に達するまで、ランダムなステップを追加し続ける
            while (cumulativePercent < 0.9) {
                // 1回の表示量 (10%～30%の間でランダム)
                const chunk = Math.random() * 0.2 + 0.1; 
                // 停止時間 (0.5秒～2秒の間でランダム)
                const pause = Math.floor(Math.random() * 1501) + 500; 

                cumulativePercent += chunk;
                steps.push({ toPercent: cumulativePercent, pauseAfter: pause });
            }

            // 最後に必ず100%で終わるようにする
            steps.push({ toPercent: 1.0, pauseAfter: 0 });
            return steps;
        }

        // ▼ ここでランダム生成関数を呼び出す ▼
        const steps = generateRandomSteps();


        // --- 以下のアニメーション実行コード ---

        const pixelsPerFrame = 5;
        const intervalTime = 16;

        function animateTo(targetHeight) {
            const revealInterval = setInterval(() => {
                let currentHeight = parseFloat(mask.style.height) || 0;
                
                if (currentHeight >= targetHeight) {
                    clearInterval(revealInterval);
                    mask.style.height = targetHeight + 'px';
                    
                    setTimeout(() => {
                        currentStepIndex++;
                        runNextStep();
                    }, steps[currentStepIndex].pauseAfter);
                } else {
                    mask.style.height = (currentHeight + pixelsPerFrame) + 'px';
                }
            }, intervalTime);
        }

        function runNextStep() {
            if (currentStepIndex >= steps.length) return;
            const targetPercent = steps[currentStepIndex].toPercent;
            const targetHeight = fullHeight * targetPercent;
            animateTo(targetHeight);
        }

        const startupInterval = setInterval(() => {
            if (image.scrollHeight > 0) {
                clearInterval(startupInterval);
                fullHeight = image.scrollHeight;
                runNextStep();
            }
        }, 100);
    </script>

</body>
</html>
